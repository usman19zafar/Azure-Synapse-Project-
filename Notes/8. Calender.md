Calendar.csv Exploration Using OPENROWSET

1. Purpose of the Calendar File
The calendar.csv file contains one row per day with pre‑split attributes:

Date (YYYY‑MM‑DD)

Year, Month, Day

Day of Week

Month Name, Day Name

Other useful calendar dimensions

This file becomes extremely valuable when joining with trip data because it enables:

Weekday vs weekend comparisons

Seasonal analysis

Month‑over‑month reporting

Day‑of‑week performance

Time‑series grouping

It is essentially a Date Dimension.

********************************************************************************************************************************************************************

2. Workflow Overview
To explore the file manually (not using UI), you must:

Switch to the correct database

Use OPENROWSET with the BULK provider

Specify:

File path

External data source

File format

Parser version

Header row

Optionally define a WITH clause for:

Correct data types

Column names

Performance optimization

********************************************************************************************************************************************************************

3. Why Write the Query by Hand?
Writing the SQL manually forces you to understand:

How Synapse reads external files

How parser versions affect performance

How column inference works

Why WITH‑clauses matter

How to control data types explicitly

This is foundational for real data engineering work.

********************************************************************************************************************************************************************

4. Key Concepts
4.1 OPENROWSET Structure

```Code
SELECT *
FROM OPENROWSET(
    BULK 'filename.csv',
    DATA_SOURCE = 'ExternalSourceName',
    FORMAT = 'CSV',
    PARSER_VERSION = '2.0',
    HEADER_ROW = TRUE
) AS alias;
```

4.2 Why Parser Version 2.0?
Faster

More stable

Better CSV handling

4.3 Why WITH Clause?
Without it:

Strings default to VARCHAR(8000)

Numbers default to BIGINT

Performance suffers

Costs increase

With it:

You control data types

You reduce memory footprint

You improve query speed

********************************************************************************************************************************************************************

5. Data Type Selection Rules
Use the smallest type that fits:

Type	Size	When to Use
TINYINT	1 byte	0–255 (e.g., day of month)
SMALLINT	2 bytes	-32k to 32k (e.g., year)
INT	4 bytes	Larger integers
BIGINT	8 bytes	Very large integers
CHAR(n)	fixed	Short codes (e.g., Mon, Tue)
VARCHAR(n)	variable	Longer text

********************************************************************************************************************************************************************

6. Ordinal Access (Advanced)
If you remove the header:

```Code
HEADER_ROW = FALSE,
FIRSTROW = 2
```
You must reference columns by position:

```Code
SELECT
    c1 AS DateKey,
    c2 AS DateValue,
    c3 AS Year
FROM OPENROWSET(...)
```
********************************************************************************************************************************************************************
7. Summary
You now know how to:

Read CSV files manually

Control parser behavior

Define data types

Explore calendar dimensions

Prepare for joining with trip data

This is core Synapse serverless skill.

FULL SQL CODE — CLEAN, PROFESSIONAL, HANDWRITTEN

1. Basic Query (No WITH Clause)

```sql
USE [NYCTaxi_Discovery];

SELECT *
FROM OPENROWSET(
    BULK 'calendar.csv',
    DATA_SOURCE = 'NYC_Taxi_Data_RAS',
    FORMAT = 'CSV',
    PARSER_VERSION = '2.0',
    HEADER_ROW = TRUE
) AS CalendarData;
```

2. WITH Clause Version (Recommended for Repeated Use)

```sql
USE [NYCTaxi_Discovery];

SELECT *
FROM OPENROWSET(
    BULK 'calendar.csv',
    DATA_SOURCE = 'NYC_Taxi_Data_RAS',
    FORMAT = 'CSV',
    PARSER_VERSION = '2.0',
    HEADER_ROW = TRUE
)
WITH (
    DateKey        INT,
    DateValue      DATE,
    YearValue      SMALLINT,
    MonthValue     TINYINT,
    DayValue       TINYINT,
    DayOfWeek      TINYINT,
    DayName        CHAR(10),
    MonthName      CHAR(10)
) AS CalendarData;
```
3. Ordinal Version (Header Removed)

```sql
USE [NYCTaxi_Discovery];

SELECT
    c1 AS DateKey,
    c2 AS DateValue,
    c3 AS YearValue,
    c4 AS MonthValue,
    c5 AS DayValue,
    c6 AS DayOfWeek,
    c7 AS DayName,
    c8 AS MonthName
FROM OPENROWSET(
    BULK 'calendar.csv',
    DATA_SOURCE = 'NYC_Taxi_Data_RAS',
    FORMAT = 'CSV',
    PARSER_VERSION = '2.0',
    HEADER_ROW = FALSE,
    FIRSTROW = 2
)
WITH (
    c1 INT,
    c2 DATE,
    c3 SMALLINT,
    c4 TINYINT,
    c5 TINYINT,
    c6 TINYINT,
    c7 CHAR(10),
    c8 CHAR(10)
) AS CalendarData;
```
