Reading Delimited Files Using OPENROWSET in Serverless SQL
__________________________________________________________
This section introduces how Synapse Serverless SQL reads delimited text files such as CSV, TSV, and other variations.
Although CSV files look simple, real‑world files contain many variations that require careful handling.

The goal of this module is to teach you how to use OPENROWSET to read remote files directly from Azure Storage without loading them into tables.

What Are Delimited Files?
Delimited files are plain text files where columns are separated by a specific character.

Common delimiters
Comma → CSV

Tab → TSV

Pipe (|)

Semicolon (;)

Custom characters

Complications in real files
Real‑world files are rarely clean. They may include:

Header rows

Different delimiters

Different row terminators

Quoted strings

Delimiters inside data

Example: "123 Main Street, Toronto"

Escaped characters

Mixed encodings

Because of this, ingestion must be flexible and controlled.
*******************************************************************************************************************************************************************
2, Why We Need OPENROWSET
Synapse Serverless SQL provides the OPENROWSET function to read files directly from Azure Storage.

What OPENROWSET does
Reads a file remotely

Returns the content as rows and columns

Allows SQL queries without creating external tables

Supports:

CSV

Parquet

Delta

This makes it ideal for exploration, prototyping, and ad‑hoc analysis.

*******************************************************************************************************************************************************************
3,  Mandatory Parameters in OPENROWSET

A. BULK
Specifies the path to the file or folder in Azure Storage.

Example:

```Code
BULK 'raw/taxi_zone.csv'
```
B. FORMAT
Specifies the file type.

Supported formats:

'CSV'

'PARQUET'

'DELTA'

Example:

```Code
FORMAT = 'CSV'
```
These two parameters are required.

*******************************************************************************************************************************************************************
4,  Optional Parameters (Critical for CSV)

CSV files vary widely, so we use optional parameters to control parsing.

Common bulk options
FIELDTERMINATOR → delimiter

ROWTERMINATOR → end of row

FIELDQUOTE → quote character

ESCAPECHAR → escape character

FIRSTROW → skip header rows

PARSER_VERSION → CSV parser engine

CSV Parser Versions
1.0 → more features, slower

2.0 → fewer features, faster (recommended)

Microsoft recommends PARSER_VERSION = '2.0' for performance.

*******************************************************************************************************************************************************************
5, Reject Options
These allow you to control what happens when the parser encounters errors.

Examples:

MAXERRORS → how many errors allowed

REJECTED_ROW_LOCATION → where to store bad rows

Useful for:

Dirty data

Inconsistent files

Production pipelines

*******************************************************************************************************************************************************************
6, What You Will Learn in This Section
This module walks through all major ingestion scenarios:

A. Reading a simple CSV file
Using default settings.

B. Exploring the Taxi Zone file
Using OPENROWSET to inspect structure and content.

C. Specifying data types and collations
Why?

Better performance

Better cost efficiency

More predictable schema

D. Querying only a subset of columns
Why?

Faster

Cheaper

Reduces data scanned

E. Handling quoted strings
Example:

```Code
"Creative Mobile Technologies, LLC"
```

You will learn:

FIELDQUOTE

ESCAPECHAR

F. Reading files with different delimiters
Example:

Tab‑separated file (TSV)

Pipe‑delimited file

You will learn:

FIELDTERMINATOR = '\t'

FIELDTERMINATOR = '|'

G. Assignments + Solutions
You will practice writing queries and then compare with provided solutions.

*******************************************************************************************************************************************************************
7,  Understanding the Documentation
The lesson also walks you through the official Microsoft documentation for OPENROWSET.

Key takeaways:

Parquet and Delta are easy because they contain schema metadata.

CSV requires more configuration because it has no schema.

All CSV options are documented under bulk options.

Reject options help manage bad data.

Parser version 2.0 is recommended for performance.

it is recommanded to explore the documentation for deeper understanding.
__________________________________________________________________________________________________________________________________________________________

Final Summary 

Delimited files vary widely in structure.

OPENROWSET allows reading remote files without loading them into tables.

CSV ingestion requires careful control of:

delimiters

quotes

escape characters

row terminators

parser version

Parquet and Delta are simpler because they contain schema.

Reject options help manage ingestion errors.

This module teaches us how to handle:

simple CSV

quoted CSV

escaped CSV

TSV

custom delimiters

selective column reading

data type specification

We will write multiple scripts and complete assignments with solutions.

This summary captures every important detail from the lesson in a clean, structured, Data‑Architect‑ready format.
